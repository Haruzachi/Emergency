CREATE DATABASE emergency_system;

USE emergency_system;

CREATE TABLE incidents (
  id INT AUTO_INCREMENT PRIMARY KEY,
  type VARCHAR(50),
  description TEXT,
  location_address VARCHAR(255),
  latitude DECIMAL(10,8),
  longitude DECIMAL(11,8),
  reported_time DATETIME,
  status VARCHAR(20) DEFAULT 'Pending',
  priority VARCHAR(10),
  dispatch_status VARCHAR(20)
);

CREATE TABLE resource_assignment (
  id INT AUTO_INCREMENT PRIMARY KEY,
  incident_id INT,
  unit_type VARCHAR(50),
  unit_name VARCHAR(100),
  dispatch_time DATETIME,
  arrival_time DATETIME,
  FOREIGN KEY (incident_id) REFERENCES incidents(id)
);

CREATE TABLE feedback (
  id INT AUTO_INCREMENT PRIMARY KEY,
  incident_id INT,
  comment TEXT,
  rating INT,
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (incident_id) REFERENCES incidents(id)
);

CREATE TABLE agencies (
	id INT AUTO_INCREMENT PRIMARY KEY,
	name VARCHAR(100),
	contact_person VARCHAR(100),
	contact_number VARCHAR(20)
);

CREATE TABLE units (
	id INT AUTO_INCREMENT PRIMARY KEY,
	unit_name VARCHAR(100),
	unit_type VARCHAR(50), -- EMS, Fire, Police
	agency_id INT,
	current_location VARCHAR(255),
	status VARCHAR(50), -- Available, Assigned, En Route
	FOREIGN KEY (agency_id) REFERENCES agencies(id)
);

ALTER TABLE incidents
  ADD COLUMN caller_name VARCHAR(100) AFTER id;

  